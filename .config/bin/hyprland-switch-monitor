#!/bin/bash

# Get the current output (monitor) that has focus
if [ ! -f ~/current_output ]; then
  current_output=$(hyprctl activewindow -j | jq -r '.monitor')
  echo "$current_output" > ~/current_output
fi

current_output=$(cat ~/current_output)

# Cycle to the next monitor ID
# MOD + Z
if [ $# -eq 0 ]; then
  # Get the highest monitor id or rather the number of all monitors FIXME if thats not the same
  number_monitors=$(hyprctl monitors -j | jq '[.[].id] | max + 1')
  # Write the next monitor in line into the current_output file
  echo $(((current_output + 1) % number_monitors)) > ~/current_output
  exit 0
fi

# Compute the workspace name based on current monitor and input workspace number
workspace="$current_output:$1"

target_output=$(cat ~/current_output)

# Check if the action is to move the window or switch workspace
if [[ "$2" == "move" ]]; then
  # Move the focused window to the target workspace
  hyprctl dispatch movetoworkspacesilent name:$workspace
else
  # Switch to the target workspace
  hyprctl dispatch workspace name:$workspace
  hyprctl dispatch moveworkspacetomonitor "$workspace" "$target_output"
fi

